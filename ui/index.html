<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Lockpick Lab</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="top">
      <div class="brand">
        <img
          class="brand-mark"
          src="./assets/general/logo.png"
          alt="Lockpick Lab logo"
          width="64"
          height="64"
        />
        <div>
          <div class="brand-title">Lockpick Lab</div>
          <div class="brand-subtitle">
            <span>Puzzle board + playback sandbox</span>
            <span class="brand-links">
              <a href="./rules.html">Rules</a>
              <a href="./cards.html">Cards</a>
            </span>
          </div>
        </div>
      </div>
        <div class="meta" id="puzzle-meta">
          <div class="meta-row">
            <span class="meta-label">Puzzle</span>
            <select class="meta-value puzzle-select" id="puzzle-select"></select>
          </div>
        <div class="meta-row">
          <span class="meta-label">Difficulty</span>
          <span class="meta-value" id="puzzle-difficulty">—</span>
        </div>
        <div class="meta-row">
          <span class="meta-label">Tags</span>
          <span class="meta-value" id="puzzle-tags">—</span>
        </div>
        <div class="meta-row">
          <span class="meta-label">Sound</span>
          <button class="btn ghost sfx-toggle" id="sfx-toggle" type="button" aria-pressed="false">
            SFX Off
          </button>
        </div>
      </div>
    </header>

    <main class="grid">
      <section class="board" id="playboard">
        <div class="side" id="boss-side">
          <div class="boss-victory" id="boss-victory">Victory</div>
          <div class="boss-failure" id="boss-failure">Failure</div>
          <div class="boss-header-row">
            <div class="boss-art">
              <img id="boss-art" src="./assets/boss/toad_dark.jpg" alt="Boss portrait" />
            </div>
            <div class="boss-info">
              <div class="boss-topbar">
                <div class="round-info">
                  <div class="round-label">Rounds left</div>
                  <div class="round-value" id="rounds-left">—</div>
                </div>
                <div class="round-info" id="mana-per-round-wrap">
                  <div class="round-label">Mana / round</div>
                  <div class="round-value" id="mana-per-round">—</div>
                </div>
                <button class="btn end-round" id="end-round">End Round</button>
              </div>
              <div class="side-header">
                <div class="side-title" id="boss-name">Boss</div>
                <div
                  class="stat boss-stat"
                  data-tooltip="Boss health. Reduce to 0 to win."
                >
                  Health <span id="opponent-health">0</span>
                  <span class="boss-poison" id="opponent-poison"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="board-section effects-section hidden" id="opponent-effects-section">
            <div class="row-label">Effects</div>
            <div class="board-row effects-row" id="opponent-effects"></div>
          </div>
          <div class="board-row" id="opponent-board"></div>
        </div>

        <div class="divider"></div>

        <div class="side">
          <div class="side-header">
            <div class="side-title">Player</div>
            <div
              class="stat mana-stat"
              data-tooltip="Mana available to play cards this round."
            >
              Mana <span id="player-mana">0</span>
            </div>
          </div>
          <div class="board-section effects-section hidden" id="player-effects-section">
            <div class="row-label">Effects</div>
            <div class="board-row effects-row" id="player-effects"></div>
          </div>
          <div class="board-row" id="player-board"></div>
          <div class="hand" id="player-hand"></div>
        </div>
      </section>

      <aside class="panel collapsed" id="puzzle-panel">
        <button class="panel-toggle" id="panel-toggle" aria-expanded="false">
          <span>Tools</span>
          <span class="panel-arrow">▸</span>
        </button>
        <div class="panel-body">
          <div class="panel-header">
            <div>
              <div class="panel-title">Puzzle Loader</div>
              <div class="panel-subtitle">Paste JSON, or load a file.</div>
            </div>
            <div class="panel-actions">
              <button class="btn" id="load-example">Load example</button>
              <label class="btn ghost" for="file-input">Choose file</label>
              <input id="file-input" type="file" accept="application/json" />
            </div>
          </div>
          <textarea id="puzzle-json" spellcheck="false"></textarea>
          <div class="panel-footer">
            <button class="btn primary" id="parse-json">Parse JSON</button>
            <div class="status" id="status">Ready.</div>
          </div>

          <div class="section">
            <div class="section-title">Generator</div>
            <div class="generator-grid">
              <label class="field">
                <span>Seed</span>
                <div class="seed-row">
                  <input id="gen-seed" type="number" placeholder="Random" />
                  <label class="seed-toggle">
                    <input id="gen-seed-random" type="checkbox" checked />
                    <span>Random</span>
                  </label>
                </div>
              </label>
              <label class="field">
                <span>Hand size</span>
                <input id="gen-hand" type="number" min="1" max="8" value="4" />
              </label>
              <label class="field">
                <span>Min used cards</span>
                <input id="gen-hand-min" type="number" min="0" max="8" value="0" />
                <span class="field-hint">0 = ignore</span>
              </label>
              <label class="field">
                <span>Decoys</span>
                <input id="gen-decoys" type="number" min="0" max="6" value="0" />
              </label>
              <label class="field">
                <span>Target rounds</span>
                <input id="gen-rounds" type="number" min="1" max="6" value="1" />
              </label>
              <label class="field">
                <span>Boss creatures (min)</span>
                <input id="gen-boss-min" type="number" min="0" max="6" value="0" />
              </label>
              <label class="field">
                <span>Boss creatures (max)</span>
                <input id="gen-boss-max" type="number" min="0" max="6" value="0" />
              </label>
              <label class="field">
                <span>Boss mods (max)</span>
                <input id="gen-boss-mods" type="number" min="0" max="4" value="0" />
                <span class="field-hint">Per creature</span>
              </label>
              <label class="field">
                <span>Max solutions</span>
                <input
                  id="gen-max-solutions"
                  type="number"
                  min="0"
                  value="1"
                />
                <span class="field-hint">0 = ignore</span>
              </label>
              <label class="field">
                <span>Action budget</span>
                <input
                  id="gen-action-budget"
                  type="number"
                  min="25"
                  max="1000"
                  value="200"
                />
              </label>
              <label class="field">
                <span>Solver budget</span>
                <input
                  id="gen-solver-budget"
                  type="number"
                  min="0"
                  max="500000"
                  value="75000"
                />
                <span class="field-hint">0 = infinite</span>
              </label>
            </div>
            <div class="generator-actions">
              <button class="btn primary" id="gen-run">Generate puzzle</button>
              <button class="btn ghost" id="gen-stop" disabled>Stop</button>
              <div class="generator-attempts">
                Attempts <span id="gen-attempts">0</span>
              </div>
            </div>
            <div class="generator-note" id="gen-note">Idle.</div>
            <div class="generator-attempt-line" id="gen-attempt-line">
              Latest attempt: —
            </div>
            <div class="generator-reject" id="gen-reject">—</div>
          </div>

          <div class="section">
            <div class="section-title">Edit Puzzle</div>
            <div class="edit-controls">
              <label class="seed-toggle">
                <input id="edit-mode" type="checkbox" />
                <span>Edit Mode</span>
              </label>
              <button class="btn ghost" id="edit-clear">Clear</button>
            </div>
            <div class="panel-subtitle">
              Left-click adds to your hand. Right-click adds a boss creature.
            </div>
            <div class="edit-card-list" id="edit-card-list"></div>
          </div>

          <div class="section">
            <div class="section-title">Legal Actions</div>
            <div class="action-list" id="action-list"></div>
          </div>

          <div class="section">
            <div class="section-title">Playback</div>
            <div class="playback-controls">
              <button class="btn ghost" id="reset-state">Reset</button>
              <button class="btn ghost" id="undo-action">Undo</button>
              <button class="btn" id="step-solution">Step solution</button>
              <button class="btn primary" id="play-solution">Auto play</button>
            </div>
            <div class="log" id="action-log"></div>
          </div>

          <div class="section">
            <div class="section-title">Solver</div>
            <div class="solver-grid">
              <label class="field">
                <span>Max wins</span>
                <input id="solve-wins-max" type="number" min="0" max="50" value="0" />
                <span class="field-hint">0 = unlimited</span>
              </label>
            </div>
            <div class="solver-actions">
              <button class="btn primary" id="solve-run">Solve</button>
              <button class="btn ghost" id="solve-stop" disabled>Stop</button>
            </div>
            <div class="solver-status">
              <div>Solutions <span id="solve-wins">0</span></div>
              <div>Visited <span id="solve-visited">0</span></div>
              <div>Expanded <span id="solve-expanded">0</span></div>
            </div>
            <div class="solver-note" id="solve-note">Idle.</div>
            <div class="solver-results" id="solve-results"></div>
          </div>
        </div>
      </aside>
    </main>

    <script type="module" src="./app.js"></script>
  </body>
</html>
